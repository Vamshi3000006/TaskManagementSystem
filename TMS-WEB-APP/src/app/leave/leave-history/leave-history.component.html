<button mat-raised-button color="primary" (click)="openApplyLeave()" style="float:right;">Apply Leave</button>
<button mat-raised-button color="primary" *ngIf="isManager" (click)="openManageLeaves()" style="float:right;">
  Manage Leaves
</button>

<div class="leave-summary-section">
<!-- Header -->
<div class="header-row">
  <h2>Leave Summary</h2>
</div>

<!-- KPI CARDS: same look & width as dashboard cards -->
<!-- Uses .card-container, .dashboard-card, .card-header, .dot, .count, .description -->
<div class="card-container">
  <mat-card *ngFor="let c of summaryCards; trackBy: trackByTitle" class="dashboard-card">
    <div class="card-header">
      <div class="dot" [style.backgroundColor]="c.dotColor"></div>
      <span class="title">{{ c.title }}</span>
    </div>
    <div class="count">{{ c.count }}</div>
    <div class="description">{{ c.description }}</div>
  </mat-card>
</div>
</div>
<!-- Leave History -->
<div class="leave-history">

  <h2>Leave History</h2>

  <!-- Loading -->
  <mat-progress-bar *ngIf="loading" mode="indeterminate"></mat-progress-bar>

  <!-- Empty State -->
  <div *ngIf="!loading && (!leaves || leaves.length === 0)" class="empty-state mat-elevation-z1">
    No leaves yet.
  </div>

  <div class="table-wrapper" *ngIf="!loading && leaves?.length">
    <table
      mat-table
      [dataSource]="dataSource"
      class="mat-elevation-z2 full-table">

      <!-- Type -->
      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef>Type</th>
        <td mat-cell *matCellDef="let r">{{ r.leaveType }}</td>
      </ng-container>

      <!-- Dates -->
      <ng-container matColumnDef="dates">
        <th mat-header-cell *matHeaderCellDef>Dates</th>
        <td mat-cell *matCellDef="let r">
          {{ r.startDate | date }} â†’ {{ r.endDate | date }} ({{ r.duration }} days)
        </td>
      </ng-container>

      <!-- Reason -->
      <ng-container matColumnDef="reason">
        <th mat-header-cell *matHeaderCellDef>Reason</th>
        <td mat-cell *matCellDef="let r">{{ r.reason }}</td>
      </ng-container>

      <!-- Status -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let r">
          <mat-chip-set>
            <mat-chip [disabled]="true">{{ r.status }}</mat-chip>
          </mat-chip-set>
        </td>
      </ng-container>

      <!-- Admin Comment -->
      <ng-container matColumnDef="Admin Comment">
        <th mat-header-cell *matHeaderCellDef>Admin Comment</th>
        <td mat-cell *matCellDef="let r">{{ r.adminComment || '-' }}</td>
      </ng-container>

      <!-- Actions -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let r">
          <button
            mat-stroked-button
            color="primary"
            (click)="update(r.id)"
            *ngIf="r.status === 'PENDING' || r.status === 'DENIED'">
            Modify
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>

  <mat-paginator [pageSizeOptions]="[10, 20, 50]" showFirstLastButtons></mat-paginator>
</div>
